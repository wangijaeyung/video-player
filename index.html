<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پخش‌کننده ویدیو (MP4 & MKV)</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/video.js/8.3.0/video-js.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/8.3.0/video.min.js"></script>
</head>
<body>

    <h2>پخش‌کننده ویدیو</h2>
    <input type="text" id="videoUrl" placeholder="لینک ویدیو را وارد کنید">
    <button onclick="loadVideo()">پخش</button>

    <video id="player" class="video-js vjs-default-skin" controls width="800">
        مرورگر شما از این فرمت پشتیبانی نمی‌کند.
    </video>

    <script>
        let player = videojs('player');

        function getParameterByName(name, url = window.location.href) {
            name = name.replace(/[]/g, "\\$&");
            let regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        function loadVideo() {
            let videoUrl = document.getElementById("videoUrl").value;
            if (videoUrl) {
                player.src({ src: videoUrl, type: getVideoType(videoUrl) });
                window.history.pushState(null, "", "?video=" + encodeURIComponent(videoUrl));
            }
        }

        function getVideoType(url) {
            if (url.endsWith(".mp4")) return "video/mp4";
            if (url.endsWith(".mkv")) return "video/x-matroska"; // ممکن است در برخی مرورگرها پشتیبانی نشود
            return "";
        }

        window.onload = function () {
            let videoSrc = getParameterByName("video");
            if (videoSrc) {
                document.getElementById("videoUrl").value = videoSrc;
                player.src({ src: videoSrc, type: getVideoType(videoSrc) });
            }
        };
    </script>

</body>
</html>
